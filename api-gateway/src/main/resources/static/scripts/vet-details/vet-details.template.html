<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet">
<link href="form.css" rel="stylesheet" type="text/css"/>
<link href="/css/ownerdetail.css" rel="stylesheet" type="text/css"/>
<link href="/css/vets/ratings.css" rel="stylesheet" type="text/css"/>

<div class="bg-light">
    <div class="container-fluid">
        <!-- Vet Information Header -->
        <div class="py-3 text-center">
            <h2 class="titleVetForm">Vet Information</h2>
        </div>


        <div class="row g-5">
            <div class="col-md-4">
                <!-- Vet Profile Photo -->
                <div class="text-center mb-4">
                    <h5>Vet Photo</h5>
                    <img alt="Profile picture preview"
                         src="data:image/*;base64,{{$ctrl.vetPhoto.photo}}"
                         width="200"
                         height="200"
                         style="border-radius: 8px; object-fit: cover; border: 2px solid #ddd;">
                </div>

                <!-- Vet Badge -->
                <div class="text-center">
                    <h5>Badge</h5>
                    <div class="parent">
                        <a style="text-decoration: none;">
                    <span class="info v{{$ctrl.badge.vetId}}"
                          ng-mouseenter="$ctrl.show($event,$ctrl.badge.vetId)"
                          ng-mouseleave="$ctrl.hide($event,$ctrl.badge.vetId)">
                        <img alt="Badge preview"
                             src="data:image/*;base64,{{$ctrl.badge.resourceBase64}}"
                             width="150"
                             height="150"
                             style="border-radius: 8px; object-fit: cover; border: 2px solid #ddd;">
                    </span>
                        </a>
                    </div>

                    <!-- Badge Modal -->
                    <div class="modal m{{$ctrl.badge.vetId}} modalOff">
                        <span class="modal_title"><b>Title:</b> {{$ctrl.badge.badgeTitle}}</span>
                        <span class="modal_date"><b>Date:</b> {{$ctrl.badge.badgeDate}}</span>
                    </div>
                </div>
            </div>

            <div class="col-md-8">
                <!-- Veterinarian Name -->
                <div class="mb-3">
                    <h4 style="margin-bottom: 0.5rem;">Veterinarian</h4>
                    <p style="font-size: 1.1rem; margin: 0;">
                        <strong>Name:</strong> {{$ctrl.vet.firstName}} {{$ctrl.vet.lastName}}
                    </p>
                </div>

                <hr>

                <!-- Contact Information -->
                <div class="mb-3">
                    <p style="margin: 0.5rem 0;">
                        <strong>Email:</strong> {{$ctrl.vet.email}}
                    </p>
                    <p style="margin: 0.5rem 0;">
                        <strong>Phone:</strong> {{$ctrl.vet.phoneNumber}}
                    </p>
                </div>

                <hr>

                <!-- Work Information Section -->
                <div class="mb-3">
                    <h4 style="margin-bottom: 1rem;">Work Information:</h4>

                    <!-- Resume -->
                    <div class="mb-3">
                        <h5 style="margin-bottom: 0.5rem;">Resume:</h5>
                        <p style="padding: 0.75rem; background-color: #f8f9fa; border-radius: 4px; border-left: 3px solid #007bff;">
                            {{$ctrl.vet.resume || 'No resume provided'}}
                        </p>
                    </div>

                    <!-- Work Days -->
                    <div class="mb-3">
                        <h5 style="margin-bottom: 0.5rem;">Work Days:</h5>
                        <div style="padding: 0.75rem; background-color: #f8f9fa; border-radius: 4px;">
                            <ul style="margin: 0; padding-left: 1.5rem; list-style: none;">
                                <li ng-repeat="workday in $ctrl.vet.workday"
                                    ng-click="$ctrl.selectWorkday(workday)"
                                    style="cursor: pointer; padding: 0.25rem 0; color: #007bff;">
                                    {{ workday }}
                                </li>
                            </ul>

                            <table id="workHoursTable"
                                   style="display: none; width: 100%; margin-top: 1rem; border-collapse: separate; border-spacing: 0;">
                                <thead>
                                <tr>
                                    <th style="background-color: #e9ecef; padding: 0.5rem; border: 1px solid #dee2e6;">Hours</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr><td id="Hour_8_9" style="padding: 0.5rem; border: 1px solid #dee2e6;">8:00-9:00</td></tr>
                                <tr><td id="Hour_9_10" style="padding: 0.5rem; border: 1px solid #dee2e6;">9:00-10:00</td></tr>
                                <tr><td id="Hour_10_11" style="padding: 0.5rem; border: 1px solid #dee2e6;">10:00-11:00</td></tr>
                                <tr><td id="Hour_11_12" style="padding: 0.5rem; border: 1px solid #dee2e6;">11:00-12:00</td></tr>
                                <tr><td id="Hour_12_13" style="padding: 0.5rem; border: 1px solid #dee2e6;">12:00-13:00</td></tr>
                                <tr><td id="Hour_13_14" style="padding: 0.5rem; border: 1px solid #dee2e6;">13:00-14:00</td></tr>
                                <tr><td id="Hour_14_15" style="padding: 0.5rem; border: 1px solid #dee2e6;">14:00-15:00</td></tr>
                                <tr><td id="Hour_15_16" style="padding: 0.5rem; border: 1px solid #dee2e6;">15:00-16:00</td></tr>
                                <tr><td id="Hour_16_17" style="padding: 0.5rem; border: 1px solid #dee2e6;">16:00-17:00</td></tr>
                                <tr><td id="Hour_17_18" style="padding: 0.5rem; border: 1px solid #dee2e6;">17:00-18:00</td></tr>
                                <tr><td id="Hour_18_19" style="padding: 0.5rem; border: 1px solid #dee2e6;">18:00-19:00</td></tr>
                                <tr><td id="Hour_19_20" style="padding: 0.5rem; border: 1px solid #dee2e6;">19:00-20:00</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Specialties with Delete Buttons -->
                    <div class="mb-3">
                        <h5 style="margin-bottom: 0.5rem;">Specialties:</h5>
                        <div style="padding: 0.75rem; background-color: #f8f9fa; border-radius: 4px;">
                            <div ng-repeat="specialty in $ctrl.vet.specialties"
                                 style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; margin-bottom: 0.5rem; background-color: white; border-radius: 4px; border: 1px solid #dee2e6;">
                                <span style="font-weight: 500;">{{specialty.name}}</span>
                                <button class="btn btn-sm btn-danger"
                                        style="padding: 0.25rem 0.75rem; font-size: 0.875rem;"
                                        ng-click="$ctrl.deleteSpecialty(specialty)">
                                    Delete
                                </button>
                            </div>
                            <p ng-if="$ctrl.vet.specialties.length === 0" style="margin: 0; color: #6c757d; font-style: italic;">
                                No specialties listed
                            </p>
                        </div>

                        <div style="margin-top: 0.75rem;">
                            <button class="btn btn-success" 
                                    style="width: 100%;"
                                    ng-click="$ctrl.addSpecialty()"
                                    ng-if="!$ctrl.addSpecialtyFormVisible">
                                + Add Specialty
                            </button>
                        </div>

                        <div ng-show="$ctrl.addSpecialtyFormVisible" style="margin-top: 1rem; padding: 1rem; background-color: white; border-radius: 4px; border: 1px solid #dee2e6;">
                            <form name="addSpecialtyForm" ng-submit="$ctrl.submitSpecialtyForm()" novalidate>
                                <div class="mb-3">
                                    <label for="specialtyName" class="form-label">Specialty Name:</label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="specialtyName"
                                           placeholder="Enter specialty name" 
                                           ng-model="$ctrl.newSpecialty.name" 
                                           required>
                                </div>
                                <div class="d-flex justify-content-end gap-2">
                                    <button type="submit" 
                                            class="btn btn-success" 
                                            ng-disabled="addSpecialtyForm.$invalid">
                                        Add
                                    </button>
                                    <button type="button" 
                                            class="btn btn-secondary ms-2" 
                                            ng-click="$ctrl.cancelSpecialtyForm()">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mb-5">
        <a ui-sref="vetEdit({vetId: $ctrl.vet.vetId})">
            <button class="btn btn-success btn-lg" style="min-width: 200px;">
                Edit Vet
            </button>
        </a>
    </div>

    <hr style="margin: 3rem 0;">

        <div>
            <h3 class="form-label-rating text-center" style="margin-top: 5%">Educations</h3>
            <div class="col-md-12" ng-if="$ctrl.educations.length > 0">
                <div class="col-md-12">
                    <div ng-if="$ctrl.educations.length === 0" style="text-align: center">
                        This vet has no educations listed.
                    </div>
                    <!-- Education Table -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Degree</th>
                            <th>Institution</th>
                            <th>Field Of Study</th>
                            <th>Start Year</th>
                            <th>End Year</th>
                            <th>Update</th>
                            <th>Delete</th>
                        </tr>
                        </thead>
                        <tbody>

                        <tr ng-repeat="education in $ctrl.educations track by education.educationId">
                            <td>{{ education.degree }}</td>
                            <td>{{ education.schoolName }}</td>
                            <td>{{ education.fieldOfStudy }}</td>
                            <td>{{ education.startDate }}</td>
                            <td>{{ education.endDate }}</td>

                            <!-- Education Update Form -->
                            <td>
                                <form enctype="multipart/form-data" id="updateEducationForm{{education.educationId}}" name="updateEducationForm">
                                    <div class="col-sm-12" name="educationUpdate" id="educationUpdate{{education.educationId}}" style="display: none">

                                        <div class="form-group">
                                            <label>Degree</label>
                                            <input type="text" class="form-control" id="updateDegree{{education.educationId}}" ng-model="education.degree" required>
                                        </div>
                                        <div class="form-group">
                                            <label>School Name</label>
                                            <input type="text" class="form-control" id="updateSchoolName{{education.educationId}}" ng-model="education.schoolName" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Field of Study</label>
                                            <input type="text" class="form-control" id="updateFieldOfStudy{{education.educationId}}" ng-model="education.fieldOfStudy" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Start Date</label>
                                            <input type="text" class="form-control" id="updateStartDate{{education.educationId}}" ng-model="education.startDate" required>
                                        </div>
                                        <div class="form-group">
                                            <label>End Date</label>
                                            <input type="text" class="form-control" id="updateEndDate{{education.educationId}}" ng-model="education.endDate" required>
                                        </div>
                                    </div>
                                </form>
                                <button class="update-vet-button btn btn-success"
                                        id="updateEducationBtn{{education.educationId}}"
                                        ng-click="$ctrl.updateEducation(education.educationId)">
                                    Update
                                </button>
                            </td>
                            <td>
                                <a class="btn btn-danger educationButton" href="javascript:void(0)" ng-click="deleteVetEducation(education.educationId)">Delete Education</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
            <!-- Vet Education add button (displays the form) -->
            <div class="container-fluid" style="margin-top: 0.5rem; margin-bottom: 2rem; text-align: left">
                <button class="add-vet-button btn btn-primary" style="width: 140px" ng-click="$ctrl.addEducationFormVisible = true" >
                   Add Education
                </button>
            </div>
            <!-- Education Form (conditionally shown) -->
            <div class="container-fluid" ng-show="$ctrl.addEducationFormVisible" style="margin-top: 1rem; margin-bottom: 2rem;">
                <form name="addEducationForm" ng-submit="$ctrl.saveEducation()" novalidate>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="School" ng-model="$ctrl.newEducation.school" required>
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="Degree" ng-model="$ctrl.newEducation.degree" required>
                        </div>
                        <div class="col-md-4">
                            <input type="number" class="form-control" placeholder="Year" ng-model="$ctrl.newEducation.year" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 text-end">
                            <button type="submit" class="btn btn-success" ng-disabled="addEducationForm.$invalid">Save</button>
                            <button type="button" class="btn btn-secondary" ng-click="$ctrl.addEducationFormVisible = false">Cancel</button>
                        </div>
                    </div>
                </form>
            </div>
        <br><br><br><br><br><br>
        </div>
    <hr>
    </div>
                <!-- tete -->
        <!-- Ratings and Add Rating -->
        <div class="row g-5">
            <!-- Percentage of ratings -->
            <div class="col-md-6" style="margin-top: 9%" ng-if="false">
                <h3 class="form-label-rating">Percentages of Ratings:</h3>
                <div class="container">
                    <div id="ratings-list" style="text-align: left; margin-left: 40%"></div>
                </div>
            </div>
            <!-- Add Rating -->
            <div class="col-md-6" ng-if="false">
                <div class="add-rating-container">
                    <!-- Add Rating -->
                    <div class="col-md-12">
                        <div class="add-rating-container">
                            <h3 class="form-label-rating">Add A Rating</h3>
                            <!-- Add Rating Form -->
                            <form enctype="multipart/form-data" id="ratingForm" name="ratingForm">
                                <div class="col-sm-12 form-label-rating">
                                    <select name="rateScore" id="ratingScore" ng-model="rating.rateScore">
                                        <option value="1">1/5</option>
                                        <option value="2">2/5</option>
                                        <option value="3">3/5</option>
                                        <option value="4">4/5</option>
                                        <option value="5">5/5</option>
                                    </select>
                                </div>
                                <div class="col-sm-12">
                                    <h5 class="form-label">Review Description</h5>
                                    <textarea class="form-control" id="ratingDescription" maxlength="350" name="description"
                                              ng-model="rating.rateDescription" pattern="^(.*)" placeholder="Description"
                                              title="Maximum of 350 characters."></textarea>
                                </div>
                                <div class="col-sm-12 form-label-rating">
                                    <label>Predefined Description:</label>
                                    <input type="checkbox" name="predefinedDescriptionPOOR{{rating.ratingId}}" value="POOR" ng-model="rating.predefinedDescriptionPOOR" ng-click="togglePredefinedDescription(rating, 'POOR')"> Poor
                                    <input type="checkbox" name="predefinedDescriptionGOOD{{rating.ratingId}}" value="GOOD" ng-model="rating.predefinedDescriptionGOOD" ng-click="togglePredefinedDescription(rating, 'GOOD')"> Good
                                    <input type="checkbox" name="predefinedDescriptionEXCELLENT{{rating.ratingId}}" value="EXCELLENT" ng-model="rating.predefinedDescriptionEXCELLENT" ng-click="togglePredefinedDescription(rating, 'EXCELLENT')"> Excellent
                                </div>

                                <br />
                                <button class="btn btn-primary ratingButton" ng-click="$ctrl.submitRatingForm(ratingForm)" type="submit">
                                    Submit
                                </button>
                                <i class="fa-solid fa-face-smile-beam"></i>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid py-4">
                <!-- RECENT & OLDER RATINGS -->
                <form onsubmit="void(0)" style="max-width: 20em; margin-top: 2em;">
                    <div class="form-group">
                        <label for="queryDate"><strong>Filter Ratings By Year</strong></label>
                        <input id="queryDate" class="form-control" ng-model="$ctrl.query" placeholder="Enter year (e.g. 2024)" type="text"/>
                    </div>
                    <button class="btn btn-primary ratingButton" ng-click="getRecentRatingBasedOnDate()" type="submit">
                        Search
                    </button>
                </form>

                <!-- Ratings Chart -->
                <div class="col-md-12" ng-if="$ctrl.ratings.length > 0" style="margin-top: 5%">
                    <div class="col-md-12">
                        <h3 class="form-label-rating text-center">Ratings</h3>
                        <div ng-if="$ctrl.ratings.length === 0" style="text-align: center">
                            This vet has no ratings.
                        </div>
                        <!-- Ratings Table -->
                        <table class="table" style="margin-bottom: 10%">
                            <thead>
                            <tr>
                                <th>Rating</th>
                                <th>Description</th>
                                <th>Update</th>
                                <th>Delete</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="rating in $ctrl.ratings track by rating.ratingId" ng-if="$ctrl.ratings.length > 0">
                                <td>{{ rating.rateScore }} / 5</td>
                                <td>{{ rating.rateDescription }}</td>

                                <!-- Rating Update Form -->
                                <td>
                                    <form enctype="multipart/form-data" id="updateForm{{rating.ratingId}}" name="updateForm">
                                        <div class="col-sm-12" name="ratingUpdate" id="ratingUpdate{{rating.ratingId}}" style="display: none">
                                            <select name="ratingOptions" id="ratingOptions{{rating.ratingId}}">
                                                <option value="1">1/5</option>
                                                <option value="2">2/5</option>
                                                <option value="3">3/5</option>
                                                <option value="4">4/5</option>
                                                <option value="5">5/5</option>
                                            </select>
                                            <br />
                                            <h5 class="form-label">Review Description</h5>
                                            <textarea class="form-control" id="updateDescription{{rating.ratingId}}" maxlength="350" name="updateDescription"
                                                      ng-model="rating.rateDescription" pattern="^(.*)" placeholder="Update Description"
                                                      title="Maximum of 350 characters."></textarea>
                                            <div class="col-sm-12 form-label-rating">
                                                <label>Predefined Description:</label>
                                                <input type="checkbox" name="predefinedDescriptionUpdate{{rating.ratingId}}" value="POOR" ng-click="$ctrl.handleCheckboxClick('POOR', rating.ratingId)"> Poor
                                                <input type="checkbox" name="predefinedDescriptionUpdate{{rating.ratingId}}" value="GOOD" ng-click="$ctrl.handleCheckboxClick('GOOD', rating.ratingId)"> Good
                                                <input type="checkbox" name="predefinedDescriptionUpdate{{rating.ratingId}}" value="EXCELLENT" ng-click="$ctrl.handleCheckboxClick('EXCELLENT', rating.ratingId)"> Excellent
                                            </div>
                                        </div>
                                    </form>

                                    <button class="update-vet-button btn btn-success"
                                            id="updateRatingBtn{{rating.ratingId}}"
                                            ng-click="$ctrl.updateRating(rating.ratingId)">
                                        Update
                                    </button>
                                </td>
                                <td>
                                    <a class="btn btn-danger ratingButton" href="javascript:void(0)" ng-click="deleteVetRating(rating.ratingId)">Delete Rating</a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
<div class="confirmation-modal-backdrop modalOff" id="confirmationBackdrop">
    <div class="confirmation-modal" id="confirmationModal">
        <div class="confirmation-modal-header">
            <h5 id="confirmationModalTitle">Confirm Action</h5>
        </div>
        <div class="confirmation-modal-body">
            <p id="confirmationModalBody">Are you sure?</p>
        </div>
        <div class="confirmation-modal-footer">
            <button class="btn btn-secondary" id="confirmationModalCancelBtn">Cancel</button>
            <button class="btn btn-success" id="confirmationModalConfirmBtn">Confirm</button>
        </div>
    </div>
</div>
    </div>
</div>

